#!/usr/bin/env perl

use utf8;
use strict;
use Encode;
use Net::SSH::Perl;

my %progs;
# $progs{'qq'} = '"C:\\Users\\amosb\\Timwp.exe"';
$progs{'qq'} = "C:\\Program` Files` `(x86`)\\Tencent\\TIM\\Bin\\timwp.exe";
# $progs{'ww'} = "C:\\Users\\amosb\\WWCmd.exe";
$progs{'ww'} = "C:\\Program` Files` `(x86`)\\AliWangWang\\9.12.10C\\WWCmd.exe";
my $prog = shift;
my $prog_name = $progs{$prog};

my $ssh = Net::SSH::Perl->new("192.168.122.109", debug=>0);
$ssh->login("amosb");
$_ = "\"$_\"" for @ARGV;
my $cmd = encode("gbk", ".\\psexec -i 2 $prog_name --% " . join(" ", @ARGV));
my ($stdout,$stderr,$exit) = $ssh->cmd($cmd);
open (my $fh, '>', '/tmp/winstart.log');
print $fh decode("gbk", $cmd);
print $fh decode("gbk", $stdout);
print $fh decode("gbk", $stderr);
print $fh decode("gbk", $exit);
close $fh;

system "bspc desktop --focus w";
