# requires: https://github.com/cyrus-and/gdb-dashboard

# enable auto-load
set auto-load safe-path /

# prefer Intel assembly syntax
set disassembly-flavor att

# GDB dashboard defaults
dashboard -layout stack expressions threads registers
dashboard -style syntax_highlighting 'monokai'
dashboard source -style context 20
dashboard assembly -style context 5
dashboard stack -style compact True
dashboard stack -style limit 3
dashboard threads -style skip-running True
set opaque-type-resolution off
set history filename ~/.gdb_history
set history save on
set history remove-duplicates 5000
set auto-solib-add off

# useful auto-redraw hooks

define hookpost-up
  dashboard
end

define hookpost-down
  dashboard
end

define hookpost-frame
  dashboard
end

# handle SIGTSTP noprint nostop pass
# handle SIGQUIT noprint nostop pass
# handle SIGINT noprint nostop pass

# set $dlopen = (void*(*)(char*, int)) dlopen
# call $dlopen("/home/amos/git/luakit/lualib.so", 1)

# If using the CLI, pagination breaks non-stop.
set pagination off
# set scheduler-locking on
# set range-stepping off
set non-stop on
# Finally, turn it on!

skip -gfi /usr/include/c++/*/*/*
skip -gfi /usr/local/include/c++/*/*/*
